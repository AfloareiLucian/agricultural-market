{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\coope\\\\Desktop\\\\olx-clone\\\\clone\\\\src\\\\Components\\\\PhoneAuth.jsx\";\nimport React, { Component } from \"react\";\nimport Form from \"react-bootstrap/Form\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Button from \"react-bootstrap/Button\";\nimport firebase from \"firebase/app\";\nimport { set_seller_data, sendData } from '../store/action/index';\nimport { Link } from \"react-router-dom\";\nimport { connect } from 'react-redux';\nimport { useHistory } from \"react-router-dom\";\n\nclass PhoneLogin extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onChangeHandler = event => {\n      const {\n        name,\n        value\n      } = event.target;\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.setUpRecaptcha = () => {\n      window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\"recaptcha-container\", {\n        size: \"invisible\",\n        callback: function (response) {\n          console.log(\"Captcha Resolved\");\n          this.onSignInSubmit();\n        },\n        defaultCountry: \"RO\"\n      });\n    };\n\n    this.onSignInSubmit = e => {\n      e.preventDefault();\n      this.setUpRecaptcha();\n      let phoneNumber = \"+40\" + this.state.mobile;\n      console.log(phoneNumber);\n      let appVerifier = window.recaptchaVerifier;\n      firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier).then(function (confirmationResult) {\n        // SMS sent. Prompt user to type the code from the message, then sign the\n        // user in with confirmationResult.confirm(code).\n        window.confirmationResult = confirmationResult; // console.log(confirmationResult);\n\n        alert(\"OTP is sent.Enter it now.\");\n      }).catch(function (error) {\n        alert(error);\n        console.log(error);\n      });\n    };\n\n    this.onSubmitOtp = e => {\n      e.preventDefault();\n      let otpInput = this.state.otp;\n      let optConfirm = window.confirmationResult;\n      console.log(otpInput);\n      optConfirm.confirm(otpInput).then(result => {\n        // User signed in successfully.\n        console.log(\"Result\" + result.verificationID);\n        let mobilePhone = this.state.mobile;\n        let previous = this.props.SELLER_DATA;\n        alert(\"Phone Number Verified Successfully\"); // let data=this.props\n\n        this.props.sendData({ ...previous,\n          mobilePhone\n        });\n        this.props.set_seller_data({ ...previous,\n          mobilePhone,\n          isSahi: true\n        });\n        let user = result.user;\n      }).catch(function (error) {\n        console.log(error);\n        alert(\"INVALID OTP.PLEASE TRY AGAIN\"); //let user = result.user;\n      });\n    };\n\n    this.state = {\n      form: true,\n      alert: false,\n      mobile: \"\",\n      isAuthenticated: false,\n      /////////////////////////////\n      time: {},\n      seconds: 5 ////////////////////////////\n\n    };\n    this.startTimer = this.startTimer.bind(this);\n    this.countDown = this.countDown.bind(this);\n    this.timer = 0;\n  } ////////////////////////////////////////////////////////////////////////////////////\n\n\n  secondsToTime(secs) {\n    let hours = Math.floor(secs / (60 * 60));\n    let divisor_for_minutes = secs % (60 * 60);\n    let minutes = Math.floor(divisor_for_minutes / 60);\n    let divisor_for_seconds = divisor_for_minutes % 60;\n    let seconds = Math.ceil(divisor_for_seconds);\n    let obj = {\n      \"h\": hours,\n      \"m\": minutes,\n      \"s\": seconds\n    };\n    return obj;\n  }\n\n  componentDidMount() {\n    let timeLeftVar = this.secondsToTime(this.state.seconds);\n    this.setState({\n      time: timeLeftVar\n    });\n  }\n\n  startTimer() {\n    if (this.timer == 0 && this.state.seconds > 0) {\n      this.timer = setInterval(this.countDown, 1000);\n    }\n  }\n\n  countDown() {\n    // Remove one second, set state so a re-render happens.\n    let seconds = this.state.seconds - 1;\n    this.setState({\n      time: this.secondsToTime(seconds),\n      seconds: seconds\n    }); // Check if we're at zero.\n\n    if (seconds == 0) {\n      clearInterval(this.timer);\n      console.log(\"This is the phone component==>\", this.props.SELLER_DATA);\n      firebase.auth().signOut();\n      this.props.history.push('/success');\n    }\n  } ////////////////////////////////////////////////////////////////////////////////////\n\n\n  render() {\n    if (this.props.SELLER_DATA.isSahi === true) {\n      console.log(\"This is the phone component==>\", this.props.SELLER_DATA);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        fluid: \"sm\",\n        className: \"mt-3\",\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          className: \"justify-content-center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            xs: 12,\n            md: 6,\n            lg: 5,\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"mb-3\",\n              children: \"Enter your Phone number\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n              className: \"text-danger\",\n              children: \"Note: Currently this service is only for +40 i.e for romania\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form, {\n              className: \"form\",\n              onSubmit: this.onSignInSubmit,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                id: \"recaptcha-container\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                  type: \"number\",\n                  name: \"mobile\",\n                  placeholder: \"Mobile Number\",\n                  onChange: this.onChangeHandler,\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                className: \"variant-primary\",\n                button: \"Submit\",\n                type: \"submit\",\n                children: \"Send OTP\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          className: \"justify-content-center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            xs: 12,\n            md: 6,\n            lg: 5,\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"mb-3\",\n              children: \"Enter OTP\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form, {\n              className: \"form\",\n              onSubmit: this.onSubmitOtp,\n              children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n                children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                  id: \"otp\",\n                  type: \"number\",\n                  name: \"otp\",\n                  placeholder: \"OTP\",\n                  onChange: this.onChangeHandler\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                button: \"Submit\",\n                type: \"submit\",\n                className: \"variant-success\",\n                children: \"Verify\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 35\n            }, this), this.props.SELLER_DATA.isSahi === true ? /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-dark\",\n                children: \"Just Click below to post your ad now\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-primary text-center\",\n                children: [\"Minutes: \", this.state.time.m, \" : Seconds: \", this.state.time.s]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-success btn-lg\",\n                onClick: this.startTimer,\n                children: \"Post Your Ad Now\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 45\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 41\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-danger\",\n                children: \"Please verify your phone number to post your Ad\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 222,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"btn btn-lg btn-primary\",\n                disabled: true,\n                children: \"Post Your Ad Now\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  SELLER_DATA: state.app.SELL,\n  USER_AUTH_DATA: state.auth.USER\n}); //updating the data of the state\n\n\nconst mapDispatchToProp = dispatch => ({\n  sendData: data => sendData(data),\n  set_seller_data: data => dispatch(set_seller_data(data))\n}); //updating the data of the state\n\n\nexport default connect(mapStateToProps, mapDispatchToProp)(PhoneLogin);","map":{"version":3,"sources":["C:/Users/coope/Desktop/olx-clone/clone/src/Components/PhoneAuth.jsx"],"names":["React","Component","Form","Container","Row","Col","Button","firebase","set_seller_data","sendData","Link","connect","useHistory","PhoneLogin","constructor","props","onChangeHandler","event","name","value","target","setState","setUpRecaptcha","window","recaptchaVerifier","auth","RecaptchaVerifier","size","callback","response","console","log","onSignInSubmit","defaultCountry","e","preventDefault","phoneNumber","state","mobile","appVerifier","signInWithPhoneNumber","then","confirmationResult","alert","catch","error","onSubmitOtp","otpInput","otp","optConfirm","confirm","result","verificationID","mobilePhone","previous","SELLER_DATA","isSahi","user","form","isAuthenticated","time","seconds","startTimer","bind","countDown","timer","secondsToTime","secs","hours","Math","floor","divisor_for_minutes","minutes","divisor_for_seconds","ceil","obj","componentDidMount","timeLeftVar","setInterval","clearInterval","signOut","history","push","render","m","s","mapStateToProps","app","SELL","USER_AUTH_DATA","USER","mapDispatchToProp","dispatch","data"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Form from \"react-bootstrap/Form\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Button from \"react-bootstrap/Button\";\nimport firebase from \"firebase/app\"\nimport { set_seller_data,sendData } from '../store/action/index'\nimport { Link } from \"react-router-dom\"\nimport { connect } from 'react-redux'\nimport { useHistory } from \"react-router-dom\";\n\nclass PhoneLogin extends React.Component {\n    constructor(props) {\n        super(props);\n\n\n        this.state = {\n            form: true,\n            alert: false,\n            mobile: \"\",\n            isAuthenticated: false\n            ,\n            /////////////////////////////\n            time: {}, seconds: 5\n            ////////////////////////////\n        };\n        this.startTimer = this.startTimer.bind(this);\n        this.countDown = this.countDown.bind(this);\n        \n        this.timer = 0;\n\n\n    }\n    ////////////////////////////////////////////////////////////////////////////////////\n\n    secondsToTime(secs) {\n        let hours = Math.floor(secs / (60 * 60));\n\n        let divisor_for_minutes = secs % (60 * 60);\n        let minutes = Math.floor(divisor_for_minutes / 60);\n\n        let divisor_for_seconds = divisor_for_minutes % 60;\n        let seconds = Math.ceil(divisor_for_seconds);\n\n        let obj = {\n            \"h\": hours,\n            \"m\": minutes,\n            \"s\": seconds\n        };\n        return obj;\n    }\n\n    componentDidMount() {\n        let timeLeftVar = this.secondsToTime(this.state.seconds);\n        this.setState({ time: timeLeftVar });\n    }\n\n    startTimer() {\n        if (this.timer == 0 && this.state.seconds > 0) {\n            this.timer = setInterval(this.countDown, 1000);\n        }\n        \n    }\n\n    countDown() {\n        // Remove one second, set state so a re-render happens.\n        let seconds = this.state.seconds - 1;\n        this.setState({\n            time: this.secondsToTime(seconds),\n            seconds: seconds,\n        });\n\n        // Check if we're at zero.\n        if (seconds == 0) {\n            clearInterval(this.timer);\n            console.log(\"This is the phone component==>\", this.props.SELLER_DATA);\n            firebase.auth().signOut();\n            this.props.history.push('/success')\n        }\n    }\n    ////////////////////////////////////////////////////////////////////////////////////\n    onChangeHandler = (event) => {\n        const { name, value } = event.target;\n        this.setState({\n            [name]: value,\n        });\n    };\n\n    setUpRecaptcha = () => {\n        window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\n            \"recaptcha-container\",\n            {\n                size: \"invisible\",\n                callback: function (response) {\n                    console.log(\"Captcha Resolved\");\n                    this.onSignInSubmit();\n                },\n                defaultCountry: \"RO\",\n            }\n        );\n    };\n\n    onSignInSubmit = (e) => {\n        e.preventDefault();\n        this.setUpRecaptcha();\n        let phoneNumber = \"+40\" + this.state.mobile;\n        console.log(phoneNumber);\n        let appVerifier = window.recaptchaVerifier;\n        firebase\n            .auth()\n            .signInWithPhoneNumber(phoneNumber, appVerifier)\n            .then(function (confirmationResult) {\n                // SMS sent. Prompt user to type the code from the message, then sign the\n                // user in with confirmationResult.confirm(code).\n                window.confirmationResult = confirmationResult;\n                // console.log(confirmationResult);\n                alert(\"OTP is sent.Enter it now.\");\n            })\n            .catch(function (error) {\n                alert(error)\n                console.log(error);\n            });\n    };\n    onSubmitOtp = (e) => {\n        e.preventDefault();\n        let otpInput = this.state.otp;\n        let optConfirm = window.confirmationResult;\n        console.log(otpInput);\n        optConfirm\n            .confirm(otpInput)\n            .then((result) => {\n                // User signed in successfully.\n                console.log(\"Result\" + result.verificationID);\n                let mobilePhone = this.state.mobile;\n                let previous = this.props.SELLER_DATA;\n                alert(\"Phone Number Verified Successfully\");\n                // let data=this.props\n              \n                this.props.sendData({\n                    ...previous,\n                    mobilePhone\n                })\n                this.props.set_seller_data({\n                    ...previous,\n                    mobilePhone,\n                    isSahi: true\n                })\n                let user = result.user;\n            })\n            .catch(function (error) {\n                console.log(error);\n                alert(\"INVALID OTP.PLEASE TRY AGAIN\");\n                //let user = result.user;\n            });\n    };\n  \n    render() {\n        \n        if (this.props.SELLER_DATA.isSahi === true) {\n            console.log(\"This is the phone component==>\", this.props.SELLER_DATA);\n            \n        }\n\n\n        return (\n            <div>\n                <Container fluid=\"sm\" className=\"mt-3\">\n                    <Row className=\"justify-content-center\">\n                        <Col xs={12} md={6} lg={5}>\n                            <h2 className=\"mb-3\">Enter your Phone number</h2>\n                            <h6 className=\"text-danger\">Note: Currently this service is only for +40 i.e for romania</h6>\n                            <Form className=\"form\" onSubmit={this.onSignInSubmit}>\n                                <div id=\"recaptcha-container\"></div>\n                                <Form.Group>\n                                    <Form.Control\n                                        type=\"number\"\n                                        name=\"mobile\"\n                                        placeholder=\"Mobile Number\"\n                                        onChange={this.onChangeHandler}\n                                        required\n                                    />\n                                </Form.Group>\n                                <Button className=\"variant-primary\" button=\"Submit\" type=\"submit\" >Send OTP</Button>\n                             \n                            </Form>\n                        </Col >\n                    </Row >\n                    <Row className=\"justify-content-center\">\n                        <Col xs={12} md={6} lg={5}>\n                            <h2 className=\"mb-3\">Enter OTP</h2>\n                            <Form className=\"form\" onSubmit={this.onSubmitOtp}>\n                                <Form.Group>\n                                    <Form.Control\n                                        id=\"otp\"\n                                        type=\"number\"\n                                        name=\"otp\"\n                                        placeholder=\"OTP\"\n                                        onChange={this.onChangeHandler}\n                                    />\n                                </Form.Group>\n                                <Button button=\"Submit\" type=\"submit\" className=\"variant-success\">Verify</Button>\n                                \n                            </Form>\n                            <br /><br />\n                    \n                            {\n                                    (this.props.SELLER_DATA.isSahi === true) ? (\n                                        <div>\n                                    \n                                \n                                            <h3 className=\"text-dark\">Just Click below to post your ad now</h3>\n                                            \n                                            <br/>\n                                            <h4 className=\"text-primary text-center\">Minutes: {this.state.time.m} : Seconds: {this.state.time.s}</h4>\n                                            <button className=\"btn btn-success btn-lg\" onClick={this.startTimer}>Post Your Ad Now</button>\n                                            \n                                        </div>\n                                    ):(\n                                        <div>\n                                        <h4 className=\"text-danger\">Please verify your phone number to post your Ad</h4>\n                                        <br/>\n                                        <button type=\"button\" className=\"btn btn-lg btn-primary\" disabled>Post Your Ad Now</button>\n                                        </div>\n                                    )\n                                }\n                        </Col>\n                    </Row>\n                </Container>\n\n            </div>\n        )\n    }\n}\nconst mapStateToProps = (state) => ({\n    SELLER_DATA: state.app.SELL,\n    USER_AUTH_DATA: state.auth.USER,\n})\n//updating the data of the state\nconst mapDispatchToProp = (dispatch) => ({\n    sendData: (data) => sendData(data),\n    set_seller_data: (data) => dispatch(set_seller_data(data))\n})\n//updating the data of the state\nexport default connect(mapStateToProps, mapDispatchToProp)(PhoneLogin);"]},"metadata":{},"sourceType":"module"}